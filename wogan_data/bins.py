import numpy as np

# K
T_grid = np.array([
50., 100., 125., 150., 175., 200., 225., 250., 275., 300., 325., 350.,
375., 400., 425., 450., 475., 500.,
550.,  600.,  650.,  700., 750., 800., 850., 900., 1000., 1100., 1200., 1300., 1400.,
1600., 1800., 2000. 
])

# Bars
P_grid = 10.0**np.arange(-6,3.01,0.5)

# atms
P_grid_atm = P_grid*(1/1.01325)

# 1/cm
wavnum = np.array([
100000,  90000,  80000,  70000,  60000,  50000,  42087,  36363,
35087,  32562,  30376,  29308,  25641,  22222,  18518,  18198,
17649,  16528,  16000,  15000,  14470,  13300,  12790,  11870,
11220,  10400,   9650,   9350,   8850,   8315,   7650,   6990,
6390,   5925,   5370,   4950,   4540,   4030,   3760,   3425,   3171,
3087,   3014,   2941,   2868,   2796,   2720,   2645,   2494,   2397,   2200,   2050,   1950,   1850,
1750,   1650,   1550,   1450,   1350,   1275,   1200,   1108,
1065,   1000,    940,    875,    800,    720,    667,    617,
545,    495,    440,    380,    330,    280,    220,    160,
100,     40,      1
])
# micron
wavl = 1e4/wavnum

# weights
weights = np.array([
1.65231051440290516E-01,
3.09768948559709378E-01,
3.09768948559709378E-01,
1.65231051440290516E-01,
8.69637112843634277E-03,
1.63036288715636482E-02,
1.63036288715636482E-02,
8.69637112843634277E-03
])

def weights_to_bins(weights):
    bins = np.empty(len(weights)+1)
    bins[0] = 0.0
    for i in range(1,len(bins)):
        bins[i] = weights[i-1] + bins[i-1]
    return bins
edges = weights_to_bins(weights)

if __name__ == '__main__':
    np.savetxt('bins.txt',wavnum[::-1].copy())
    np.savetxt('PFile.txt',P_grid_atm)